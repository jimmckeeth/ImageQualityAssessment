FROM python:3.9\-slim-bullseye

# Install system dependencies and build tools  
RUN apt-get update && apt-get install \-y \\  
 wget build-essential cmake git \\  
 libjpeg-dev libpng-dev libtiff-dev \\  
 libwebp-dev webp libheif-dev libjxl-dev

# Compile ImageMagick 7 Source  
RUN wget <https://github.com/ImageMagick/ImageMagick/archive/refs/tags/7.1.1-30.tar.gz> && \\  
 tar xzf 7.1.1-30.tar.gz && \\  
 cd ImageMagick-7.1.1-30 && \\  
 ./configure \--with-heic=yes \--with-jxl=yes \--with-webp=yes && \\  
 make \-j4 && make install && ldconfig

# Install Python plotting lib  
RUN pip install matplotlib

# Set up working directory  
WORKDIR /analysis  
COPY compression_analyzer.py.

ENTRYPOINT \["python", "compression_analyzer.py"\]